I'm sorry, but it is not possible to provide the source code of the entire refactored file as it is not complete. The code you provided is just a header file with some definitions and includes, which is not sufficient for refactoring.